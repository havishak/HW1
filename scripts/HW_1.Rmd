---
title: "HW 1"
author: 
    - Havi Khurana
    - Cassie Malcom
    - Merly Klaas
date: "2/10/2022"
output: 
    html_document:
        toc: TRUE
        toc_float: TRUE
        code_folding: hide
        highlight: kate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      error = FALSE)

#load packages
pacman::p_load(tidyverse, gghighlight, ggtext, ggrepel)
```

```{r read-data}
transit_cost <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-05/transit_cost.csv')
```

## Question 1

Use the transit costs data to reproduce the following plot. 

## Question 2

Visualize the same relation, but displaying the uncertainty using an alternative method of your choosing.

## Question 3

Compute the mean length and real_cost by city. Reproduce the following plot.

```{r}
transit_cost %>% 
    group_by(country,city) %>% 
    summarise(
        n = n(),
        length_mean = mean(length, na.rm = TRUE),
        real_cost_mean = mean(as.numeric(real_cost), na.rm = TRUE) #real_cost is char
    ) %>% 
    ggplot(aes(x = length_mean, y = real_cost_mean))+
    geom_point(aes(size = n), color = "#bf35cf")+
    scale_x_log10(limits = c(-1, 200))+
    scale_y_log10(labels = scales::dollar)+
    scale_size_binned(name = "Number of transit systems", breaks = c(5, 10, 20))+
    gghighlight(country == "IN",
                unhighlighted_params = list(color = "gray80"))+
    geom_text_repel(aes(label = city),
                  min.segment.length = 0)+
  labs(
    title = "Longer transit systems tend to cost more",
    subtitle = "<span style = 'color: #bf35cf'>**India**</span> has among the most transit systems in the world",
    x = "Average length",
    y = "Average cost",
    caption = "Note the log transformation to the axes"
     )+
    theme_minimal(base_size = 14)+
    theme(
        plot.subtitle = element_markdown(),
        legend.position="bottom",
        plot.title.position = "plot"
    )
```


## Question 4

Using basically the same data, reproduce the following plot. Note youâ€™ll need the country_name column in your dataset.

```{r}
library(ggforce)
q4 <- transit_cost %>% 
    group_by(country,city) %>% 
    summarise(
        n = n(),
        length_mean = mean(length, na.rm = TRUE),
        real_cost_mean = mean(as.numeric(real_cost), na.rm = TRUE) #real_cost is char
    ) %>% 
    mutate(
        country_name = ifelse(country == "US", "United States", NA)
    )

q4 %>% 
    ggplot(aes(x = length_mean, y = real_cost_mean))+
    geom_point(aes(size = n), color = "gray80")+
    scale_size_binned(name = "Number of transit systems", breaks = c(5, 10, 20))+
    geom_point(data = filter(q4,country == "US"), color = "#2596be", show.legend = FALSE)+
    scale_x_log10(limits = c(-1, 200))+
    scale_y_log10(labels = scales::dollar)+
    geom_mark_ellipse(aes(group = country, 
                    label = country_name),
                    data = filter(drop_na(q4),
                                  country == "US"),
                    label.colour = "#2596be",
                    con.colour = "pink",
                    color = "pink",
                    expand = unit(1, "mm"))+
    geom_label_repel(data = filter(drop_na(q4),country == "US"), 
                     aes(label = city),
                    min.segment.length = 0, 
                    color = "gray60")+
  labs(
    title = "Longer transit systems tend to cost more",
    x = "Average length",
    y = "Average cost",
    caption = "Note the log transformation to the axes"
     )+
    theme_minimal(base_size = 14)+
    theme(
        plot.subtitle = element_markdown(),
        legend.position="bottom",
        plot.title.position = "plot"
    )
```

## Question 5

Use the crime dataset to run the following code and fit the corresponding model. Note, it may take a moment to run.

